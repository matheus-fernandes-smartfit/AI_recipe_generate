{"version":3,"sources":["../../../src/utils/editor.ts"],"sourcesContent":["import spawnAsync from '@expo/spawn-async';\nimport fs from 'node:fs';\nimport path from 'node:path';\nimport process from 'node:process';\n\nimport { env } from './env';\nimport * as Log from '../log';\n\nconst debug = require('debug')('expo:utils:editor') as typeof console.log;\n\ninterface Editor {\n  id: string;\n  name: string;\n  binary: string;\n  isTerminalEditor: boolean;\n  isOSXOnly?: boolean;\n  paths: string[];\n  keywords: string[];\n}\n\n// See: https://github.com/sindresorhus/env-editor/blob/3f6aea10ff53910c877b1bf73a8e0c954a5fbf11/index.js\n// MIT License, Copyright (c) Sindre Sorhus <sindresorhus@gmail.com> (https://sindresorhus.com)\nfunction getEditor(input: string | undefined, allowAnyEditor = false): Editor | null {\n  const needle = input?.trim().toLowerCase();\n  if (!needle) {\n    return null;\n  }\n  const id = needle.split(/[/\\\\]/).pop()?.replace(/\\s/g, '-');\n  const binary = id?.split('-')[0];\n  const editor =\n    EDITORS.find((editor) => {\n      switch (needle) {\n        case editor.id:\n        case editor.name.toLowerCase():\n        case editor.binary:\n          return true;\n        default:\n          for (const editorPath of editor.paths) {\n            if (path.normalize(needle) === path.normalize(editorPath.toLowerCase())) return true;\n          }\n          for (const keyword of editor.keywords) {\n            if (needle === keyword) return true;\n          }\n          return false;\n      }\n    }) ?? (binary ? EDITORS.find((editor) => editor.binary === binary) : null);\n  if (allowAnyEditor && id && binary && !editor) {\n    return {\n      id,\n      name: needle,\n      binary,\n      isTerminalEditor: false,\n      paths: [],\n      keywords: [],\n    };\n  }\n  return editor || null;\n}\n\n/** Guess what the default editor is and default to VSCode. */\nexport function guessEditor(): Editor | null {\n  let editor: Editor | null = null;\n  if (env.EXPO_EDITOR) {\n    editor = getEditor(env.EXPO_EDITOR);\n    if (editor) {\n      debug('Using $EXPO_EDITOR:', editor.name);\n    }\n  }\n\n  if (!editor && process.env.VISUAL) {\n    editor = getEditor(process.env.VISUAL);\n    if (editor) {\n      debug('Using $VISUAL:', editor.name);\n    }\n  }\n\n  if (!editor && process.env.EDITOR) {\n    editor = getEditor(process.env.EDITOR);\n    if (editor) {\n      debug('Using $EDITOR:', editor.name);\n    }\n  }\n\n  return editor;\n}\n\nexport async function guessFallbackVisualEditor(): Promise<Editor | null> {\n  // We search for editors at known `editor.paths`\n  for (const editor of VISUAL_EDITORS) {\n    const target = await editorExistsAtPaths(editor);\n    if (target) {\n      debug('Found visual editor fallback:', editor.name);\n      return { ...editor, binary: target };\n    }\n  }\n  // We search again for a visual editor against `editor.binary` in `$PATH`\n  for (const editor of VISUAL_EDITORS) {\n    const target = await editorExistsInPath(editor);\n    if (target) {\n      debug('Found visual editor fallback in $PATH:', editor.name);\n      return { ...editor, binary: target };\n    }\n  }\n  return null;\n}\n\nlet _cachedEditor: Editor | null | undefined;\n\nasync function determineEditorAsync(): Promise<Editor | null> {\n  if (_cachedEditor !== undefined) {\n    return _cachedEditor;\n  }\n\n  // First: Try to get a known editor\n  let editor = guessEditor();\n\n  // Second: If we don't have a known editor, fall back to EXPO_EDITOR / VISUAL resolution\n  // We check if the binary in these environment variables exists in the $PATH\n  const forceEditorName = env.EXPO_EDITOR ?? process.env.VISUAL;\n  if (!editor && forceEditorName) {\n    const forceEditor = getEditor(forceEditorName, true);\n    if (forceEditor && (await editorExistsInPath(forceEditor))) {\n      editor = forceEditor;\n    }\n  }\n\n  // Third: Try to find a fallback visual editor, but keep the found one if we can't find a fallback\n  if (editor?.isTerminalEditor) {\n    const fallback = await guessFallbackVisualEditor();\n    if (fallback) {\n      editor = fallback;\n    }\n  }\n\n  return (_cachedEditor = editor);\n}\n\n/** Open a file path in a given editor. */\nexport async function openInEditorAsync(path: string, lineNumber?: number): Promise<boolean> {\n  const editor = await determineEditorAsync();\n\n  if (editor && !editor.isTerminalEditor) {\n    const fileReference = lineNumber ? `${path}:${lineNumber}` : path;\n    debug(\n      `Opening ${fileReference} in ${editor?.name} (bin: ${editor?.binary}, id: ${editor?.id})`\n    );\n\n    if (editor) {\n      try {\n        await spawnAsync(editor.binary, getEditorArguments(editor, path, lineNumber), {\n          timeout: 1_000,\n        });\n        return true;\n      } catch (error: any) {\n        // NOTE(@kitten): The process might explicitly request to be terminated, which is fine\n        if (error?.signal === 'SIGTERM') {\n          return true;\n        }\n        debug(\n          `Failed to open ${fileReference} in editor (path: ${path}, binary: ${editor.binary}):`,\n          error\n        );\n      }\n    }\n  }\n\n  Log.error(\n    (editor?.isTerminalEditor\n      ? `Could not open ${editor.name} as it's a terminal editor.`\n      : 'Could not open editor.') +\n      `\\nYou can set an editor for Expo to open by defining the $EXPO_EDITOR or $VISUAL environment variable (e.g. \"vscode\" or \"atom\")`\n  );\n  return false;\n}\n\nfunction getEditorArguments(editor: Editor, path: string, lineNumber?: number): string[] {\n  switch (editor.id) {\n    case 'atom':\n    case 'sublime':\n      return lineNumber ? [`${path}:${lineNumber}`] : [path];\n\n    case 'emacs':\n    case 'emacsforosx':\n    case 'nano':\n    case 'neovim':\n    case 'vim':\n      return lineNumber ? [`+${lineNumber}`, path] : [path];\n\n    case 'android-studio':\n    case 'intellij':\n    case 'textmate':\n    case 'webstorm':\n    case 'xcode':\n      return lineNumber ? [`--line=${lineNumber}`, path] : [path];\n\n    case 'vscode':\n    case 'vscodium':\n    case 'cursor':\n      return lineNumber ? ['-g', `${path}:${lineNumber}`] : ['-g', path];\n\n    case 'zed':\n      // '-r': Stands for \"--reuse\" and ensures we don't use the `zed` GUI binary, since the Zed CLI\n      // is linked as `zed` into `$PATH` when it's actually the CLI\n      return lineNumber ? ['-r', `${path}:${lineNumber}`] : ['-r', path];\n\n    default:\n      return [path];\n  }\n}\n\n/** Attempt to resolve an editor against $PATH */\nasync function editorExistsInPath(editor: Editor) {\n  if (process.platform !== 'darwin' && editor.isOSXOnly) {\n    return null;\n  }\n  const binary = editor.binary;\n  const paths = (process.env.PATH || process.env.Path || '')\n    .split(path.delimiter)\n    .map((target) => target.trim())\n    .filter((target) => !!target);\n  const exts =\n    process.platform === 'win32'\n      ? (process.env.PATHEXT || '.EXE;.CMD;.BAT;.COM').split(path.delimiter).filter(Boolean)\n      : [''];\n  const targets = paths.flatMap((dir) => exts.map((ext) => path.join(dir, `${binary}${ext}`)));\n  for (const target of targets) {\n    try {\n      const mode = process.platform === 'win32' ? fs.constants.F_OK : fs.constants.X_OK;\n      await fs.promises.access(target, mode);\n      return target;\n    } catch {\n      // ignore not found and continue\n    }\n  }\n  return null;\n}\n\n/** Attempt to resolve an editor against known `paths` */\nasync function editorExistsAtPaths(editor: Editor) {\n  // We can skip the path if it's not for our platform (win32 vs posix paths)\n  const targets = editor.paths.filter((target) => target.includes(path.sep));\n  for (const target of targets) {\n    try {\n      const mode = process.platform === 'win32' ? fs.constants.F_OK : fs.constants.X_OK;\n      await fs.promises.access(target, mode);\n      return target;\n    } catch {\n      // ignore not found and continue\n    }\n  }\n  return null;\n}\n\nconst TERMINAL_EDITORS: (Editor & { isTerminalEditor: true })[] = [\n  {\n    id: 'vim',\n    name: 'Vim',\n    binary: 'vim',\n    isTerminalEditor: true,\n    paths: [],\n    keywords: ['vi'],\n  },\n  {\n    id: 'neovim',\n    name: 'NeoVim',\n    binary: 'nvim',\n    isTerminalEditor: true,\n    paths: [],\n    keywords: ['vim'],\n  },\n  {\n    id: 'nano',\n    name: 'GNU nano',\n    binary: 'nano',\n    isTerminalEditor: true,\n    paths: [],\n    keywords: [],\n  },\n  {\n    id: 'emacs',\n    name: 'GNU Emacs',\n    binary: 'emacs',\n    isTerminalEditor: true,\n    paths: [],\n    keywords: [],\n  },\n];\n\nconst VISUAL_EDITORS: (Editor & { isTerminalEditor: false })[] = [\n  {\n    id: 'vscode',\n    name: 'Visual Studio Code',\n    binary: 'code',\n    isTerminalEditor: false,\n    paths: ['/Applications/Visual Studio Code.app/Contents/Resources/app/bin/code'],\n    keywords: ['vs code'],\n  },\n  {\n    id: 'vscode-insiders',\n    name: 'Visual Studio Code - Insiders',\n    binary: 'code-insiders',\n    isTerminalEditor: false,\n    paths: [\n      '/Applications/Visual Studio Code - Insiders.app/Contents/Resources/app/bin/code-insiders',\n    ],\n    keywords: ['vs code insiders', 'code insiders', 'insiders'],\n  },\n  {\n    id: 'vscodium',\n    name: 'VSCodium',\n    binary: 'codium',\n    isTerminalEditor: false,\n    paths: ['/Applications/VSCodium.app/Contents/Resources/app/bin/codium'],\n    keywords: [],\n  },\n  {\n    id: 'cursor',\n    name: 'Cursor',\n    binary: 'cursor',\n    isTerminalEditor: false,\n    paths: ['/Applications/Cursor.app/Contents/Resources/app/bin/codium'],\n    keywords: [],\n  },\n  {\n    id: 'sublime',\n    name: 'Sublime Text',\n    binary: 'subl',\n    isTerminalEditor: false,\n    paths: [\n      '/Applications/Sublime Text.app/Contents/SharedSupport/bin/subl',\n      '/Applications/Sublime Text 2.app/Contents/SharedSupport/bin/subl',\n    ],\n    keywords: [],\n  },\n  {\n    id: 'atom',\n    name: 'Atom',\n    binary: 'atom',\n    isTerminalEditor: false,\n    paths: ['/Applications/Atom.app/Contents/Resources/app/atom.sh'],\n    keywords: [],\n  },\n  {\n    id: 'webstorm',\n    name: 'WebStorm',\n    binary: 'webstorm',\n    isTerminalEditor: false,\n    paths: [],\n    keywords: ['wstorm'],\n  },\n  {\n    id: 'phpstorm',\n    name: 'PhpStorm',\n    binary: 'pstorm',\n    isTerminalEditor: false,\n    paths: [],\n    keywords: ['php'],\n  },\n  {\n    id: 'zed',\n    name: 'Zed',\n    binary: 'zed',\n    isTerminalEditor: false,\n    paths: ['/Applications/Zed.app/Contents/MacOS/cli'],\n    keywords: [],\n  },\n  {\n    id: 'textmate',\n    name: 'TextMate',\n    binary: 'mate',\n    isTerminalEditor: false,\n    paths: [],\n    keywords: [],\n  },\n  {\n    id: 'intellij',\n    name: 'IntelliJ IDEA',\n    binary: 'idea',\n    isTerminalEditor: false,\n    paths: [],\n    keywords: ['idea', 'java', 'jetbrains', 'ide'],\n  },\n  {\n    id: 'emacsforosx',\n    name: 'GNU Emacs for Mac OS X',\n    binary: 'Emacs',\n    isTerminalEditor: false,\n    isOSXOnly: true,\n    paths: ['/Applications/Emacs.app/Contents/MacOS/Emacs'],\n    keywords: [],\n  },\n  {\n    id: 'xcode',\n    name: 'Xcode',\n    binary: 'xed',\n    isTerminalEditor: false,\n    isOSXOnly: true,\n    paths: [\n      '/Applications/Xcode.app/Contents/MacOS/Xcode',\n      '/Applications/Xcode-beta.app/Contents/MacOS/Xcode',\n    ],\n    keywords: ['xed'],\n  },\n  {\n    id: 'android-studio',\n    name: 'Android Studio',\n    binary: 'studio',\n    isTerminalEditor: false,\n    paths: [\n      '/Applications/Android Studio.app/Contents/MacOS/studio',\n      '/usr/local/Android/android-studio/bin/studio.sh',\n      'C:\\\\Program Files (x86)\\\\Android\\\\android-studio\\\\bin\\\\studio.exe',\n      'C:\\\\Program Files\\\\Android\\\\android-studio\\\\bin\\\\studio64.exe',\n    ],\n    keywords: ['studio'],\n  },\n];\n\nconst EDITORS: Editor[] = [...VISUAL_EDITORS, ...TERMINAL_EDITORS];\n"],"names":["guessEditor","guessFallbackVisualEditor","openInEditorAsync","debug","require","getEditor","input","allowAnyEditor","needle","trim","toLowerCase","id","split","pop","replace","binary","editor","EDITORS","find","name","editorPath","paths","path","normalize","keyword","keywords","isTerminalEditor","env","EXPO_EDITOR","process","VISUAL","EDITOR","VISUAL_EDITORS","target","editorExistsAtPaths","editorExistsInPath","_cachedEditor","determineEditorAsync","undefined","forceEditorName","forceEditor","fallback","lineNumber","fileReference","spawnAsync","getEditorArguments","timeout","error","signal","Log","platform","isOSXOnly","PATH","Path","delimiter","map","filter","exts","PATHEXT","Boolean","targets","flatMap","dir","ext","join","mode","fs","constants","F_OK","X_OK","promises","access","includes","sep","TERMINAL_EDITORS"],"mappings":";;;;;;;;;;;IA4DgBA,WAAW;eAAXA;;IA0BMC,yBAAyB;eAAzBA;;IAoDAC,iBAAiB;eAAjBA;;;;gEA1IC;;;;;;;gEACR;;;;;;;gEACE;;;;;;;gEACG;;;;;;qBAEA;6DACC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAErB,MAAMC,QAAQC,QAAQ,SAAS;AAY/B,yGAAyG;AACzG,+FAA+F;AAC/F,SAASC,UAAUC,KAAyB,EAAEC,iBAAiB,KAAK;QAKvDC;IAJX,MAAMA,SAASF,yBAAAA,MAAOG,IAAI,GAAGC,WAAW;IACxC,IAAI,CAACF,QAAQ;QACX,OAAO;IACT;IACA,MAAMG,MAAKH,oBAAAA,OAAOI,KAAK,CAAC,SAASC,GAAG,uBAAzBL,kBAA6BM,OAAO,CAAC,OAAO;IACvD,MAAMC,SAASJ,sBAAAA,GAAIC,KAAK,CAAC,IAAI,CAAC,EAAE;IAChC,MAAMI,SACJC,QAAQC,IAAI,CAAC,CAACF;QACZ,OAAQR;YACN,KAAKQ,OAAOL,EAAE;YACd,KAAKK,OAAOG,IAAI,CAACT,WAAW;YAC5B,KAAKM,OAAOD,MAAM;gBAChB,OAAO;YACT;gBACE,KAAK,MAAMK,cAAcJ,OAAOK,KAAK,CAAE;oBACrC,IAAIC,mBAAI,CAACC,SAAS,CAACf,YAAYc,mBAAI,CAACC,SAAS,CAACH,WAAWV,WAAW,KAAK,OAAO;gBAClF;gBACA,KAAK,MAAMc,WAAWR,OAAOS,QAAQ,CAAE;oBACrC,IAAIjB,WAAWgB,SAAS,OAAO;gBACjC;gBACA,OAAO;QACX;IACF,MAAOT,CAAAA,SAASE,QAAQC,IAAI,CAAC,CAACF,SAAWA,OAAOD,MAAM,KAAKA,UAAU,IAAG;IAC1E,IAAIR,kBAAkBI,MAAMI,UAAU,CAACC,QAAQ;QAC7C,OAAO;YACLL;YACAQ,MAAMX;YACNO;YACAW,kBAAkB;YAClBL,OAAO,EAAE;YACTI,UAAU,EAAE;QACd;IACF;IACA,OAAOT,UAAU;AACnB;AAGO,SAAShB;IACd,IAAIgB,SAAwB;IAC5B,IAAIW,QAAG,CAACC,WAAW,EAAE;QACnBZ,SAASX,UAAUsB,QAAG,CAACC,WAAW;QAClC,IAAIZ,QAAQ;YACVb,MAAM,uBAAuBa,OAAOG,IAAI;QAC1C;IACF;IAEA,IAAI,CAACH,UAAUa,sBAAO,CAACF,GAAG,CAACG,MAAM,EAAE;QACjCd,SAASX,UAAUwB,sBAAO,CAACF,GAAG,CAACG,MAAM;QACrC,IAAId,QAAQ;YACVb,MAAM,kBAAkBa,OAAOG,IAAI;QACrC;IACF;IAEA,IAAI,CAACH,UAAUa,sBAAO,CAACF,GAAG,CAACI,MAAM,EAAE;QACjCf,SAASX,UAAUwB,sBAAO,CAACF,GAAG,CAACI,MAAM;QACrC,IAAIf,QAAQ;YACVb,MAAM,kBAAkBa,OAAOG,IAAI;QACrC;IACF;IAEA,OAAOH;AACT;AAEO,eAAef;IACpB,gDAAgD;IAChD,KAAK,MAAMe,UAAUgB,eAAgB;QACnC,MAAMC,SAAS,MAAMC,oBAAoBlB;QACzC,IAAIiB,QAAQ;YACV9B,MAAM,iCAAiCa,OAAOG,IAAI;YAClD,OAAO;gBAAE,GAAGH,MAAM;gBAAED,QAAQkB;YAAO;QACrC;IACF;IACA,yEAAyE;IACzE,KAAK,MAAMjB,UAAUgB,eAAgB;QACnC,MAAMC,SAAS,MAAME,mBAAmBnB;QACxC,IAAIiB,QAAQ;YACV9B,MAAM,0CAA0Ca,OAAOG,IAAI;YAC3D,OAAO;gBAAE,GAAGH,MAAM;gBAAED,QAAQkB;YAAO;QACrC;IACF;IACA,OAAO;AACT;AAEA,IAAIG;AAEJ,eAAeC;IACb,IAAID,kBAAkBE,WAAW;QAC/B,OAAOF;IACT;IAEA,mCAAmC;IACnC,IAAIpB,SAAShB;IAEb,wFAAwF;IACxF,4EAA4E;IAC5E,MAAMuC,kBAAkBZ,QAAG,CAACC,WAAW,IAAIC,sBAAO,CAACF,GAAG,CAACG,MAAM;IAC7D,IAAI,CAACd,UAAUuB,iBAAiB;QAC9B,MAAMC,cAAcnC,UAAUkC,iBAAiB;QAC/C,IAAIC,eAAgB,MAAML,mBAAmBK,cAAe;YAC1DxB,SAASwB;QACX;IACF;IAEA,kGAAkG;IAClG,IAAIxB,0BAAAA,OAAQU,gBAAgB,EAAE;QAC5B,MAAMe,WAAW,MAAMxC;QACvB,IAAIwC,UAAU;YACZzB,SAASyB;QACX;IACF;IAEA,OAAQL,gBAAgBpB;AAC1B;AAGO,eAAed,kBAAkBoB,IAAY,EAAEoB,UAAmB;IACvE,MAAM1B,SAAS,MAAMqB;IAErB,IAAIrB,UAAU,CAACA,OAAOU,gBAAgB,EAAE;QACtC,MAAMiB,gBAAgBD,aAAa,GAAGpB,KAAK,CAAC,EAAEoB,YAAY,GAAGpB;QAC7DnB,MACE,CAAC,QAAQ,EAAEwC,cAAc,IAAI,EAAE3B,0BAAAA,OAAQG,IAAI,CAAC,OAAO,EAAEH,0BAAAA,OAAQD,MAAM,CAAC,MAAM,EAAEC,0BAAAA,OAAQL,EAAE,CAAC,CAAC,CAAC;QAG3F,IAAIK,QAAQ;YACV,IAAI;gBACF,MAAM4B,IAAAA,qBAAU,EAAC5B,OAAOD,MAAM,EAAE8B,mBAAmB7B,QAAQM,MAAMoB,aAAa;oBAC5EI,SAAS;gBACX;gBACA,OAAO;YACT,EAAE,OAAOC,OAAY;gBACnB,sFAAsF;gBACtF,IAAIA,CAAAA,yBAAAA,MAAOC,MAAM,MAAK,WAAW;oBAC/B,OAAO;gBACT;gBACA7C,MACE,CAAC,eAAe,EAAEwC,cAAc,kBAAkB,EAAErB,KAAK,UAAU,EAAEN,OAAOD,MAAM,CAAC,EAAE,CAAC,EACtFgC;YAEJ;QACF;IACF;IAEAE,KAAIF,KAAK,CACP,AAAC/B,CAAAA,CAAAA,0BAAAA,OAAQU,gBAAgB,IACrB,CAAC,eAAe,EAAEV,OAAOG,IAAI,CAAC,2BAA2B,CAAC,GAC1D,wBAAuB,IACzB,CAAC,+HAA+H,CAAC;IAErI,OAAO;AACT;AAEA,SAAS0B,mBAAmB7B,MAAc,EAAEM,IAAY,EAAEoB,UAAmB;IAC3E,OAAQ1B,OAAOL,EAAE;QACf,KAAK;QACL,KAAK;YACH,OAAO+B,aAAa;gBAAC,GAAGpB,KAAK,CAAC,EAAEoB,YAAY;aAAC,GAAG;gBAACpB;aAAK;QAExD,KAAK;QACL,KAAK;QACL,KAAK;QACL,KAAK;QACL,KAAK;YACH,OAAOoB,aAAa;gBAAC,CAAC,CAAC,EAAEA,YAAY;gBAAEpB;aAAK,GAAG;gBAACA;aAAK;QAEvD,KAAK;QACL,KAAK;QACL,KAAK;QACL,KAAK;QACL,KAAK;YACH,OAAOoB,aAAa;gBAAC,CAAC,OAAO,EAAEA,YAAY;gBAAEpB;aAAK,GAAG;gBAACA;aAAK;QAE7D,KAAK;QACL,KAAK;QACL,KAAK;YACH,OAAOoB,aAAa;gBAAC;gBAAM,GAAGpB,KAAK,CAAC,EAAEoB,YAAY;aAAC,GAAG;gBAAC;gBAAMpB;aAAK;QAEpE,KAAK;YACH,8FAA8F;YAC9F,6DAA6D;YAC7D,OAAOoB,aAAa;gBAAC;gBAAM,GAAGpB,KAAK,CAAC,EAAEoB,YAAY;aAAC,GAAG;gBAAC;gBAAMpB;aAAK;QAEpE;YACE,OAAO;gBAACA;aAAK;IACjB;AACF;AAEA,+CAA+C,GAC/C,eAAea,mBAAmBnB,MAAc;IAC9C,IAAIa,sBAAO,CAACqB,QAAQ,KAAK,YAAYlC,OAAOmC,SAAS,EAAE;QACrD,OAAO;IACT;IACA,MAAMpC,SAASC,OAAOD,MAAM;IAC5B,MAAMM,QAAQ,AAACQ,CAAAA,sBAAO,CAACF,GAAG,CAACyB,IAAI,IAAIvB,sBAAO,CAACF,GAAG,CAAC0B,IAAI,IAAI,EAAC,EACrDzC,KAAK,CAACU,mBAAI,CAACgC,SAAS,EACpBC,GAAG,CAAC,CAACtB,SAAWA,OAAOxB,IAAI,IAC3B+C,MAAM,CAAC,CAACvB,SAAW,CAAC,CAACA;IACxB,MAAMwB,OACJ5B,sBAAO,CAACqB,QAAQ,KAAK,UACjB,AAACrB,CAAAA,sBAAO,CAACF,GAAG,CAAC+B,OAAO,IAAI,qBAAoB,EAAG9C,KAAK,CAACU,mBAAI,CAACgC,SAAS,EAAEE,MAAM,CAACG,WAC5E;QAAC;KAAG;IACV,MAAMC,UAAUvC,MAAMwC,OAAO,CAAC,CAACC,MAAQL,KAAKF,GAAG,CAAC,CAACQ,MAAQzC,mBAAI,CAAC0C,IAAI,CAACF,KAAK,GAAG/C,SAASgD,KAAK;IACzF,KAAK,MAAM9B,UAAU2B,QAAS;QAC5B,IAAI;YACF,MAAMK,OAAOpC,sBAAO,CAACqB,QAAQ,KAAK,UAAUgB,iBAAE,CAACC,SAAS,CAACC,IAAI,GAAGF,iBAAE,CAACC,SAAS,CAACE,IAAI;YACjF,MAAMH,iBAAE,CAACI,QAAQ,CAACC,MAAM,CAACtC,QAAQgC;YACjC,OAAOhC;QACT,EAAE,OAAM;QACN,gCAAgC;QAClC;IACF;IACA,OAAO;AACT;AAEA,uDAAuD,GACvD,eAAeC,oBAAoBlB,MAAc;IAC/C,2EAA2E;IAC3E,MAAM4C,UAAU5C,OAAOK,KAAK,CAACmC,MAAM,CAAC,CAACvB,SAAWA,OAAOuC,QAAQ,CAAClD,mBAAI,CAACmD,GAAG;IACxE,KAAK,MAAMxC,UAAU2B,QAAS;QAC5B,IAAI;YACF,MAAMK,OAAOpC,sBAAO,CAACqB,QAAQ,KAAK,UAAUgB,iBAAE,CAACC,SAAS,CAACC,IAAI,GAAGF,iBAAE,CAACC,SAAS,CAACE,IAAI;YACjF,MAAMH,iBAAE,CAACI,QAAQ,CAACC,MAAM,CAACtC,QAAQgC;YACjC,OAAOhC;QACT,EAAE,OAAM;QACN,gCAAgC;QAClC;IACF;IACA,OAAO;AACT;AAEA,MAAMyC,mBAA4D;IAChE;QACE/D,IAAI;QACJQ,MAAM;QACNJ,QAAQ;QACRW,kBAAkB;QAClBL,OAAO,EAAE;QACTI,UAAU;YAAC;SAAK;IAClB;IACA;QACEd,IAAI;QACJQ,MAAM;QACNJ,QAAQ;QACRW,kBAAkB;QAClBL,OAAO,EAAE;QACTI,UAAU;YAAC;SAAM;IACnB;IACA;QACEd,IAAI;QACJQ,MAAM;QACNJ,QAAQ;QACRW,kBAAkB;QAClBL,OAAO,EAAE;QACTI,UAAU,EAAE;IACd;IACA;QACEd,IAAI;QACJQ,MAAM;QACNJ,QAAQ;QACRW,kBAAkB;QAClBL,OAAO,EAAE;QACTI,UAAU,EAAE;IACd;CACD;AAED,MAAMO,iBAA2D;IAC/D;QACErB,IAAI;QACJQ,MAAM;QACNJ,QAAQ;QACRW,kBAAkB;QAClBL,OAAO;YAAC;SAAuE;QAC/EI,UAAU;YAAC;SAAU;IACvB;IACA;QACEd,IAAI;QACJQ,MAAM;QACNJ,QAAQ;QACRW,kBAAkB;QAClBL,OAAO;YACL;SACD;QACDI,UAAU;YAAC;YAAoB;YAAiB;SAAW;IAC7D;IACA;QACEd,IAAI;QACJQ,MAAM;QACNJ,QAAQ;QACRW,kBAAkB;QAClBL,OAAO;YAAC;SAA+D;QACvEI,UAAU,EAAE;IACd;IACA;QACEd,IAAI;QACJQ,MAAM;QACNJ,QAAQ;QACRW,kBAAkB;QAClBL,OAAO;YAAC;SAA6D;QACrEI,UAAU,EAAE;IACd;IACA;QACEd,IAAI;QACJQ,MAAM;QACNJ,QAAQ;QACRW,kBAAkB;QAClBL,OAAO;YACL;YACA;SACD;QACDI,UAAU,EAAE;IACd;IACA;QACEd,IAAI;QACJQ,MAAM;QACNJ,QAAQ;QACRW,kBAAkB;QAClBL,OAAO;YAAC;SAAwD;QAChEI,UAAU,EAAE;IACd;IACA;QACEd,IAAI;QACJQ,MAAM;QACNJ,QAAQ;QACRW,kBAAkB;QAClBL,OAAO,EAAE;QACTI,UAAU;YAAC;SAAS;IACtB;IACA;QACEd,IAAI;QACJQ,MAAM;QACNJ,QAAQ;QACRW,kBAAkB;QAClBL,OAAO,EAAE;QACTI,UAAU;YAAC;SAAM;IACnB;IACA;QACEd,IAAI;QACJQ,MAAM;QACNJ,QAAQ;QACRW,kBAAkB;QAClBL,OAAO;YAAC;SAA2C;QACnDI,UAAU,EAAE;IACd;IACA;QACEd,IAAI;QACJQ,MAAM;QACNJ,QAAQ;QACRW,kBAAkB;QAClBL,OAAO,EAAE;QACTI,UAAU,EAAE;IACd;IACA;QACEd,IAAI;QACJQ,MAAM;QACNJ,QAAQ;QACRW,kBAAkB;QAClBL,OAAO,EAAE;QACTI,UAAU;YAAC;YAAQ;YAAQ;YAAa;SAAM;IAChD;IACA;QACEd,IAAI;QACJQ,MAAM;QACNJ,QAAQ;QACRW,kBAAkB;QAClByB,WAAW;QACX9B,OAAO;YAAC;SAA+C;QACvDI,UAAU,EAAE;IACd;IACA;QACEd,IAAI;QACJQ,MAAM;QACNJ,QAAQ;QACRW,kBAAkB;QAClByB,WAAW;QACX9B,OAAO;YACL;YACA;SACD;QACDI,UAAU;YAAC;SAAM;IACnB;IACA;QACEd,IAAI;QACJQ,MAAM;QACNJ,QAAQ;QACRW,kBAAkB;QAClBL,OAAO;YACL;YACA;YACA;YACA;SACD;QACDI,UAAU;YAAC;SAAS;IACtB;CACD;AAED,MAAMR,UAAoB;OAAIe;OAAmB0C;CAAiB"}